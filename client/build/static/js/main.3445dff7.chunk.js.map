{"version":3,"sources":["utils.ts","store/user/sagas.ts","store/user/types.ts","store/user/actions.ts","store/user/reducer.ts","store/user/selectors.ts","store/room/types.ts","store/room/sagas.ts","store/room/actions.ts","store/room/reducer.ts","store/room/selectors.ts","store/rootReducer.ts","store/rootServices.ts","store/rootSaga.ts","store/index.ts","scenes/RoomUser/withStreamAnalyzer.tsx","components/UI/UIAppLayout.tsx","components/UI/UIAudioStream.tsx","components/UI/UIBar.tsx","components/UI/UIButton.tsx","components/UI/UIContainer.tsx","components/UI/UIIconToggle.tsx","components/UI/UIInput.tsx","components/UI/UILoader.tsx","components/UI/UILogo.tsx","components/UI/UIPaper.tsx","scenes/Start/Start.tsx","scenes/Room/components/RoomBottomBar.tsx","scenes/Room/components/RoomEnter.tsx","scenes/Room/components/RoomMessage.tsx","scenes/Room/components/RoomTopBar.tsx","scenes/RoomUser/components/RoomUserAction.tsx","scenes/RoomUser/components/RoomUserAnalyzer.tsx","scenes/RoomUser/components/RoomUserItem.tsx","scenes/RoomUser/RoomUser.tsx","scenes/Room/components/RoomUsers.tsx","scenes/Room/Room.tsx","scenes/Room/withRoomCheck.tsx","App.tsx","index.tsx","../node_modules/peerjs/dist sync"],"names":["emoji","getRandomEmoji","Math","floor","random","length","getMediaStream","navigator","mediaDevices","getUserMedia","audio","then","stream","catch","error","watchCreateStream","take","UserTypes","CREATE_STREAM","call","userStream","active","put","userActions","updateUser","prefix","UPDATE_USER","createAction","createStream","userReducer","createReducer","userId","userName","userEmoji","state","payload","getTracks","stop","userSelectors","s","user","RoomTypes","CREATE_ROOM","CHECK_ROOM","JOIN_ROOM","LEAVE_ROOM","UPDATE_ROOM","CALL_ROOM_USERS","UPDATE_ROOM_USER","UPDATE_ROOM_USERS","watchRoomChannel","watchCreateRoom","watchCheckRoom","watchJoinRoom","watchCallRoomUsers","watchLeaveRoom","roomChannel","socket","peer","eventChannel","emit","on","room","roomActions","updateRoom","updateRoomUsers","roomChecked","answer","store","getState","remoteStream","dispatch","updateRoomUser","channel","action","roomId","select","roomSelectors","roomUsers","slice","forEach","callRoomUsers","createRoom","checkRoom","joinRoom","leaveRoom","initialState","roomHost","roomStatus","roomReducer","isNew","roomUser","filter","u","userIndex","findIndex","rootReducer","combineReducers","IS_PROD","process","connectSocket","Promise","res","io","connectPeer","Peer","sessionStorage","getItem","undefined","secure","host","port","path","config","iceServers","urls","credential","username","setItem","rootSaga","id","fork","userSagas","roomSagas","sagaMiddleware","createSagaMiddleware","createStore","composeWithDevTools","applyMiddleware","run","Component","UIAppLayout","children","className","UIAudioStream","React","memo","audioState","audioRef","useRef","useLayoutEffect","current","srcObject","play","volume","muted","ref","UIBar","cx","UIButton","type","classIcon","onClick","UIContainer","UIIconToggle","onClass","offClass","UIInput","name","placeholder","autoFocus","register","onChange","useState","value","setValue","e","target","UILoader","classNameItem","UILogo","icon","UIPaper","Start","history","useHistory","useDispatch","useSelector","shortid","generate","push","RoomBottomBar","RoomEnter","useForm","handleSubmit","onSubmit","RoomMessage","loader","toStart","RoomTopBar","copyRoomLink","RoomUserAction","RoomUserAnalyzer","analyzerState","style","width","size","height","RoomUserItem","RoomUser","withMuted","setAudioState","Number","props","requestId","audioContext","setAnalyzerState","useEffect","analyzer","AudioContext","createAnalyser","createMediaStreamSource","connect","updateAnalyzerState","window","requestAnimationFrame","array","Uint8Array","frequencyBinCount","getByteFrequencyData","cancelAnimationFrame","close","RoomUsers","map","Room","useParams","withRoomCheck","loadingRoom","setLoadingRoom","isCalledRoom","setIsCalledRoom","document","title","join","Fragment","text","location","href","clipboard","writeText","App","exact","component","ReactDOM","render","StrictMode","getElementById","webpackEmptyContext","req","Error","code","keys","resolve","module","exports"],"mappings":"opBAAMA,EAAQ,CAAC,eAAM,eAAM,eAAM,eAAM,gBAE1BC,EAAiB,WAC5B,OAAOD,EAAME,KAAKC,MAAMD,KAAKE,SAAWF,KAAKC,MAAMH,EAAMK,WAO9CC,EAAiB,WAC5B,OAAOC,UAAUC,aACdC,aAAa,CACZC,OAAO,IAERC,MAAK,SAACC,GAAD,OAAYA,KACjBC,OAAM,SAACC,GAAD,OAAWA,M,WCZLC,GAAV,SAAUA,IAAV,uFAGD,OAHC,SAGKC,YAAKC,EAAUC,eAHpB,OAIkB,OAJlB,SAIwBC,YAAKb,GAJ7B,OAKD,OADMc,EAJL,gBAKKA,EAAWC,QAAUC,YAAIC,EAAYC,WAAW,CAAEJ,gBALvD,sI,YCJDK,EAAS,QAEFR,EAAY,CACvBS,YAAY,GAAD,OAAKD,EAAL,eACXP,cAAc,GAAD,OAAKO,EAAL,kBCDFF,EAAc,CACzBC,WAAYG,YAA0CV,EAAUS,aAChEE,aAAcD,YAAaV,EAAUC,gB,OCF1BW,EAAcC,YACzB,CACEC,OAAQ,GACRC,SAAU,GACVC,UAAW,GACXb,WAAY,MAEd,CACE,CAACH,EAAUS,aAAc,SAACQ,EAAD,GAA2C,IAAD,EAAhCC,EAAgC,EAAhCA,QAGjC,OAFCA,EAAQf,aAAT,UAAuBc,EAAMd,kBAA7B,OAAuB,EAAkBgB,YAAY,GAAGC,QACxDH,EAAK,2BAAQA,GAAUC,MCVhBG,EACL,SAACC,GAAD,OAA6BA,EAAEC,M,QCJjCf,EAAS,QAEFgB,EAAY,CACvBC,YAAY,GAAD,OAAKjB,EAAL,eACXkB,WAAW,GAAD,OAAKlB,EAAL,cACVmB,UAAU,GAAD,OAAKnB,EAAL,aACToB,WAAW,GAAD,OAAKpB,EAAL,cACVqB,YAAY,GAAD,OAAKrB,EAAL,eACXsB,gBAAgB,GAAD,OAAKtB,EAAL,mBACfuB,iBAAiB,GAAD,OAAKvB,EAAL,oBAChBwB,kBAAkB,GAAD,OAAKxB,EAAL,sB,WCgCFyB,G,WAYAC,G,WAWAC,G,WAWAC,G,WAaAC,G,WAqBAC,GA9FjB,SAASC,EAAYC,EAA+BC,GAClD,OAAOC,aAAa,SAACC,GAqBnB,OApBAH,EAAOI,GAAG,eAAe,SAACC,GACxBF,EAAKG,EAAYC,WAAWF,OAE9BL,EAAOI,GAAG,qBAAqB,SAACrB,GAC9BoB,EAAKG,EAAYE,gBAAgBzB,OAEnCiB,EAAOI,GAAG,eAAe,SAACC,GACxBF,EAAKG,EAAYC,WAAZ,2BAA4BF,GAA5B,IAAkCI,aAAa,SAEtDR,EAAKG,GAAG,QAAQ,SAAC1C,GACfA,EAAKgD,OAAOC,GAAMC,WAAW7B,KAAKpB,YAClCD,EAAK0C,GAAG,UAAU,SAACS,GACjBF,GAAMG,SACJR,EAAYS,eAAe,CACzBzC,OAAQZ,EAAKuC,KACbtC,WAAYkD,WAKb,gBAIJ,SAAUpB,EAAiBO,EAA+BC,GAA1D,yEAEa,OAFb,kBAEmBvC,YAAKqC,EAAaC,EAAQC,GAF7C,OAEGe,EAFH,cAIc,OAJd,SAIoBzD,YAAKyD,GAJzB,OAKD,OADMC,EAJL,iBAKKpD,YAAIoD,GALT,uIAYA,SAAUvB,EAAgBM,GAA1B,yFAGmB,OAHnB,SAGyBzC,YAAKyB,EAAUC,aAHxC,gBAGOP,EAHP,EAGOA,QACRsB,EAAOG,KAAK,cAAezB,GAJ1B,8HAWA,SAAUiB,EAAeK,GAAzB,yFAGmB,OAHnB,SAGyBzC,YAAKyB,EAAUE,YAHxC,gBAGOR,EAHP,EAGOA,QACRsB,EAAOG,KAAK,aAAczB,GAJzB,8HAWA,SAAUkB,EAAcI,GAAxB,6FAGmB,OAHnB,SAGyBzC,YAAKyB,EAAUG,WAHxC,OAKD,OALC,SAGOT,EAHP,EAGOA,QACAwC,EAAoBxC,EAApBwC,OAAWnC,EAJlB,YAI2BL,EAJ3B,qBAKKb,YAAIC,EAAYC,WAAZ,eAA4BgB,KALrC,OAMDiB,EAAOG,KAAK,YAAZ,aAA2Be,UAAWnC,IANrC,+HAaA,SAAUc,EAAmBI,GAA7B,6EAEH,OAFG,kBAEG1C,YAAKyB,EAAUM,iBAFlB,OAG8B,OAH9B,SAGoC6B,YAAOC,EAAcf,MAHzD,OAI+B,OAJ/B,SAGKgB,EAHL,EAGKA,UAHL,SAIqCF,YAAOtC,GAJ5C,gBAIKlB,EAJL,EAIKA,WACR0D,EAAUC,MAAM,GAAGC,SAAQ,YAAiB,IAAdjD,EAAa,EAAbA,OACf2B,EAAKvC,KAAKY,EAAQX,GAC1ByC,GAAG,UAAU,SAACS,GACjBF,GAAMG,SACJR,EAAYS,eAAe,CACzBzC,SACAX,WAAYkD,WAXjB,wGAqBA,SAAUf,EAAeE,GAAzB,yFAGmB,OAHnB,SAGyBzC,YAAKyB,EAAUI,YAHxC,gBAGOV,EAHP,EAGOA,QACRsB,EAAOG,KAAK,aAAczB,GAJzB,8HClGA,IAAM4B,EAAc,CACzBkB,cAAetD,YAAac,EAAUM,iBACtCmC,WAAYvD,YAA0Cc,EAAUC,aAChEyC,UAAWxD,YAAyCc,EAAUE,YAC9DyC,SAAUzD,YAAwCc,EAAUG,WAC5DyC,UAAW1D,YAAyCc,EAAUI,YAC9DmB,WAAYrC,YAA0Cc,EAAUK,aAChE0B,eAAgB7C,YACdc,EAAUO,kBAEZiB,gBAAiBtC,YACfc,EAAUQ,oB,QCdRqC,EAAe,CACnBX,OAAQ,GACRY,SAAU,GACVT,UAAW,GACXU,YAAY,EACZtB,aAAa,GAGFuB,EAAc3D,YAAyBwD,EAAc,CAChE,CAAC7C,EAAUK,aAAc,SAACZ,EAAD,GAA2C,IAAjCC,EAAgC,EAAhCA,QAEjC,OADAD,EAASC,EAAD,2BAA+BD,GAAUC,GAA9BmD,GAGrB,CAAC7C,EAAUQ,mBAAoB,SAC7Bf,EAD6B,GAGzB,IADFC,EACC,EADDA,QAKF,OAHAD,EAAM4C,UAAY3C,EAAQuD,MAAR,sBACVxD,EAAM4C,WADI,CACO3C,EAAQwD,WAC7BzD,EAAM4C,UAAUc,QAAO,SAACC,GAAD,OAAOA,EAAE9D,SAAWI,EAAQwD,SAAS5D,UACzDG,GAET,CAACO,EAAUO,kBAAmB,SAACd,EAAD,GAA+C,IAArCC,EAAoC,EAApCA,QAChC2D,EAAY5D,EAAM4C,UAAUiB,WAChC,SAACF,GAAD,OAAOA,EAAE9D,SAAWI,EAAQJ,UAG9B,OADAG,EAAM4C,UAAUgB,GAAhB,2BAAkC5D,EAAM4C,UAAUgB,IAAe3D,GAC1DD,KCjCE2C,EAAgB,CAC3Bf,KAAM,SAACvB,GAAD,OAA6BA,EAAEuB,OCK1BkC,EAAcC,0BAA2B,CACpDzD,OACAsB,S,qCCRIoC,IAAUC,EAEHC,GAAgB,kBAC3B,IAAIC,SAAQ,SAACC,GACX,IAAM7C,EAAS8C,OACf9C,EAAOI,GAAG,WAAW,WACnByC,EAAI7C,UAIG+C,GAAc,kBACzB,IAAIH,SAAQ,SAACC,GACX,IAAM5C,EAAO,IAAI+C,IAAKC,eAAeC,QAAQ,gBAAaC,EAAW,CACnEC,OAAQX,GACRY,KAAgB,wBAChBC,KAAgB,IAChBC,KAAM,YACNC,OAAQ,CACNC,WAAY,CACV,CAAEC,KAAM,gCACR,CACEA,KAAM,wBACNC,WAAY,SACZC,SAAU,uBAKlB3D,EAAKG,GAAG,QAAQ,SAAC9B,GACf2E,eAAeY,QAAQ,SAAUvF,GACjCuE,EAAI5C,U,YC5BO6D,IAAV,SAAUA,KAAV,yEACQ,OADR,SACcpG,YAAKqF,IADnB,OAEU,OADT9C,EADD,gBAEgBvC,YAAKiF,IAFrB,OAGL,OADM3C,EAFD,gBAGCnC,YAAIC,EAAYC,WAAW,CAAEO,OAAQ2B,EAAK8D,MAH3C,OAIL,OAJK,UAICC,YAAKC,EAAU3G,mBAJhB,QAKL,OALK,UAKC0G,YAAKE,EAAUxE,gBAAiBM,GALjC,QAML,OANK,UAMCgE,YAAKE,EAAUvE,eAAgBK,GANhC,QAOL,OAPK,UAOCgE,YAAKE,EAAUtE,cAAeI,GAP/B,QAQL,OARK,UAQCgE,YAAKE,EAAUpE,eAAgBE,GARhC,QASL,OATK,UASCgE,YAAKE,EAAUrE,mBAAoBI,GATpC,QAUL,OAVK,UAUC+D,YAAKE,EAAUzE,iBAAkBO,EAAQC,GAV1C,yCCCP,IAAMkE,GAAiBC,cAEVzD,GAAQ0D,sBACnB9B,EACA+B,8BAAoBC,0BAAgBJ,MAGtCA,GAAeK,IAAIV,I,ICLjBW,G,SCNWC,GAAwB,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SACtC,OACE,qBAAKC,UAAU,+CAAf,SACGD,KCIME,GAAiCC,IAAMC,MAClD,YAAiC,IAA9BpH,EAA6B,EAA7BA,WAAYqH,EAAiB,EAAjBA,WACPC,EAAWH,IAAMI,OAAyB,MAehD,OAbAJ,IAAMK,iBAAgB,WAAO,IAAD,EACtBF,EAASG,WAAW,UAACH,EAASG,eAAV,aAAC,EAAkBC,aACzCJ,EAASG,QAAQC,UAAY1H,EAC7BsH,EAASG,QAAQE,UAElB,CAACL,EAAUtH,IAEdmH,IAAMK,iBAAgB,WAChBF,EAASG,UACXH,EAASG,QAAQG,OAASP,EAAWQ,MAAQ,EAAI,KAElD,CAACR,EAAWQ,QAER,uBAAOC,IAAKR,O,mBCnBVS,GAAyB,SAAC,GAAkC,IAAD,IAA/Bd,iBAA+B,MAAnB,GAAmB,EAAfD,EAAe,EAAfA,SACvD,OACE,qBACEC,UAAWe,KACTf,EACA,mFAHJ,SAMGD,KCLMiB,GAA4B,SAAC,GAMnC,IAAD,IALJC,YAKI,MALG,SAKH,MAJJjB,iBAII,MAJQ,GAIR,MAHJkB,iBAGI,MAHQ,GAGR,EAFJC,EAEI,EAFJA,QACApB,EACI,EADJA,SAEA,OACE,yBACEkB,KAAMA,EACNjB,UAAWe,KACTf,EACA,qLAEFmB,QAASA,GAAY,aANvB,UAQGD,GAAa,mBAAGlB,UAAWe,KAAGG,EAAW,aAC1C,+BAAOnB,QCpBAqB,GAA+B,SAAC,GAAkC,IAAD,IAA/BpB,iBAA+B,MAAnB,GAAmB,EAAfD,EAAe,EAAfA,SAC7D,OACE,qBAAKC,UAAWe,KAAGf,EAAW,0BAA9B,SAA0DD,KCAjDsB,GAAgC,SAAC,GAIvC,IAHLxH,EAGI,EAHJA,MAGI,IAFJyH,eAEI,MAFM,GAEN,MADJC,gBACI,MADO,GACP,EACJ,OAAO,mBAAGvB,UAAWe,KAAG,CAAE,CAACO,GAAUzH,EAAO,CAAC0H,IAAY1H,O,SCA9C2H,GAAU,SAAC,GASV,IARZC,EAQW,EARXA,KAQW,IAPXR,YAOW,MAPJ,OAOI,MANXhE,oBAMW,MANI,GAMJ,MALXyE,mBAKW,MALG,GAKH,MAJX1B,iBAIW,MAJC,GAID,MAHX2B,iBAGW,SAFXC,EAEW,EAFXA,SACAC,EACW,EADXA,SACW,EACe3B,IAAM4B,SAAS7E,GAD9B,oBACJ8E,EADI,KACGC,EADH,KAQX,OACE,uBACEf,KAAMA,EACNQ,KAAMA,EACNM,MAAOA,EACPlB,IAAKe,EACLD,UAAWA,EACXD,YAAaA,EACb1B,UAAWe,KACTf,EACA,sLAEF6B,SAjBgB,SAACI,GACnBD,EAASC,EAAEC,OAAOH,OAClBF,GAAYA,EAASI,OCnBZE,I,OAA4B,SAAC,GAAkC,IAAhCnC,EAA+B,EAA/BA,UAAWoC,EAAoB,EAApBA,cACrD,OACE,sBAAKpC,UAAWe,KAAG,uBAAwBf,GAA3C,UACE,qBACEA,UAAWe,KAAG,sCAAuCqB,KAEvD,qBACEpC,UAAWe,KAAG,sCAAuCqB,UCPhDC,GAA0BnC,IAAMC,MAAK,YAA0B,IAAvBmC,EAAsB,EAAtBA,KAAMtC,EAAgB,EAAhBA,UACzD,OACE,qBACEA,UAAWe,KACTf,EACA,uFAHJ,SAMGsC,GAAQ1K,SCVF2K,GAA2B,SAAC,GAAkC,IAAD,IAA/BvC,iBAA+B,MAAnB,GAAmB,EAAfD,EAAe,EAAfA,SACzD,OACE,qBAAKC,UAAWe,KAAGf,EAAW,2BAA9B,SAA2DD,K,oBCDlDyC,GAAQ,WACnB,IAAMC,EAAUC,eACVxG,EAAWyG,cACTjJ,EAAWkJ,YAAY3I,GAAvBP,OAaR,OACE,cAAC,GAAD,CAAasG,UAAU,gDAAvB,SACE,sBAAKA,UAAU,6CAAf,UACE,sBAAKA,UAAU,YAAf,UACE,cAACqC,GAAD,CAAQC,KAAK,eAAKtC,UAAU,+BAC5B,mBAAGA,UAAU,sCAAb,kEAIF,cAAC,GAAD,CACEA,UAAU,4DACVmB,QAtBqB,WAC3B,IAAM7E,EAASuG,KAAQC,WACvB5G,EACER,EAAYmB,WAAW,CACrBP,SACA5C,YAGJ+I,EAAQM,KAAR,WAAiBzG,KAYb,oCC1BK0G,GAAiC,SAAC,GAAmB,IAAjBhG,EAAgB,EAAhBA,UAC/C,OACE,cAAC,GAAD,CAAOgD,UAAU,oCAAjB,SASE,cAAC,GAAD,CACEA,UAAU,2DACVkB,UAAU,sBACVC,QAASnE,EAHX,sB,SCROiG,GAA6B,SAAC,GAIpC,IAHLrJ,EAGI,EAHJA,UACAoD,EAEI,EAFJA,UACAD,EACI,EADJA,SACI,EAC+BmG,eAA3BtB,EADJ,EACIA,SAAUuB,EADd,EACcA,aAElB,OACE,sBAAKnD,UAAU,yDAAf,UACE,sBAAKA,UAAU,YAAf,UACE,cAACqC,GAAD,CAAQrC,UAAU,+BAA+BsC,KAAM1I,IACvD,qBAAIoG,UAAU,iCAAd,6BACkB,uBADlB,2BAIF,uBACEA,UAAU,4CACVoD,SAAUD,EAAapG,GAFzB,UAIE,cAAC,GAAD,CACEiD,UAAU,sEACVyB,KAAK,WACLC,YAAY,YACZE,SAAUA,EACVD,WAAS,IAEX,sBAAK3B,UAAU,0EAAf,UACE,cAAC,GAAD,CACEA,UAAU,iDACViB,KAAK,SACLC,UAAU,qBAHZ,mBAOA,cAAC,GAAD,CACElB,UAAU,2DACVkB,UAAU,oBACVC,QAASnE,EAHX,6BClCGqG,GAA+B,SAAC,GAKtC,IAAD,IAJJf,YAII,MAJG,GAIH,MAHJgB,cAGI,SAFJC,EAEI,EAFJA,QACAxD,EACI,EADJA,SAEA,OACE,sBAAKC,UAAU,gDAAf,UACE,sBAAKA,UAAU,YAAf,UACGsC,IAASgB,GACR,cAACjB,GAAD,CAAQrC,UAAU,+BAA+BsC,KAAMA,IAExDgB,GACC,cAAC,GAAD,CAAUtD,UAAU,YAAYoC,cAAc,gBAEhD,oBACEpC,UAAWe,KACT,yBACAuC,EAAS,yBAA2B,YAHxC,SAMGvD,OAGJwD,GACC,cAAC,GAAD,CACEvD,UAAU,oDACVkB,UAAU,oBACVC,QAASoC,EAHX,uBC3BKC,GAA8B,SAAC,GAA8B,IAA5BlH,EAA2B,EAA3BA,OAAQmH,EAAmB,EAAnBA,aACpD,OACE,eAAC,GAAD,CAAOzD,UAAU,wBAAjB,UACE,cAAC,GAAD,CACEA,UAAU,4CACVkB,UAAU,eACVC,QAASsC,EAHX,uBAOA,uBAAMzD,UAAU,oBAAhB,UACE,sBAAMA,UAAU,gBAAhB,sBADF,IACmD1D,SCX5CoH,GAAkC,SAAC,GAAD,QAC7C1D,iBAD6C,MACjC,GADiC,EAE7CmB,EAF6C,EAE7CA,QACApB,EAH6C,EAG7CA,SAH6C,OAK7C,wBACEC,UAAWe,KACTf,EACA,wJAEFmB,QAASA,EALX,SAOGpB,KCdQ4D,GAAmB,SAAC,GAA8B,IAA5BC,EAA2B,EAA3BA,cACjC,OACE,qBACEC,MAAO,CACLC,OAAoB,OAAbF,QAAa,IAAbA,OAAA,EAAAA,EAAeG,OAAQ,EAC9BC,QAAqB,OAAbJ,QAAa,IAAbA,OAAA,EAAAA,EAAeG,OAAQ,GAEjC/D,UAAU,oECNHiE,GAAgC,SAAC,GAAD,QAAGjE,iBAAH,MAAe,GAAf,EAAmBD,EAAnB,EAAmBA,SAAnB,OAC3C,qBACEC,UAAWe,KACTf,EACA,wEAHJ,SAMGD,KCIQmE,InBVXrE,GmBWA,YAA2E,IAAxElG,EAAuE,EAAvEA,SAAUC,EAA6D,EAA7DA,UAAWb,EAAkD,EAAlDA,WAAY6K,EAAsC,EAAtCA,cAAsC,IAAvBO,iBAAuB,WACpCjE,IAAM4B,SAAS,CAAElB,OAAQuD,IADW,oBACjE/D,EADiE,KACrDgE,EADqD,KAOxE,OACE,sBAAKpE,UAAU,8CAAf,UACE,eAAC,GAAD,CACEA,UAAWe,KACT,uIACA,CACE,wBAAyBsD,OAAM,OAACT,QAAD,IAACA,OAAD,EAACA,EAAeG,MAAQ,MAJ7D,UAQE,qBAAK/D,UAAU,wCAAf,SACGmE,GACC,cAAC,GAAD,CAAgBhD,QAhBF,WACtBiD,GAAc,SAAClK,GAAD,mBAAC,eAAYA,GAAb,IAAgB0G,OAAQ1G,EAAE0G,YAehC,SACE,cAAC,GAAD,CACE/G,OAAQuG,EAAWQ,MACnBU,QAAQ,mBACRC,SAAS,gDAKjB,cAACc,GAAD,CACErC,UAAU,6CACVsC,KAAM1I,IAER,cAAC,GAAD,CAAkBgK,cAAeA,IACjC,sBAAK5D,UAAU,4CAAf,UACE,cAAC,GAAD,UACE,cAAC,GAAD,CACEnG,OAAO,EACPyH,QAAQ,oBACRC,SAAS,2CAGb,cAAC,GAAD,CAAcvB,UAAU,OAAxB,SACGrG,GAAY,kBAIlBZ,GACC,cAACkH,GAAD,CAAelH,WAAYA,EAAYqH,WAAYA,QnBzDxD,SAACkE,GACJ,IAAIC,EACAC,EAEIzL,EAAeuL,EAAfvL,WAJS,EAKyBmH,IAAM4B,SAAS,CAAEiC,KAAM,IALhD,oBAKVH,EALU,KAKKa,EALL,KA6BjB,OAtBAvE,IAAMwE,WAAU,WACd,GAAI3L,IAAeyL,EAAc,CAE/B,IAAMG,GADNH,EAAe,IAAII,cACWC,iBAY9B,OAXAL,EAAaM,wBAAwB/L,GAAYgM,QAAQJ,GAE7B,SAAtBK,IACJT,EAAYU,OAAOC,sBAAsBF,GACzC,IAAMG,EAAQ,IAAIC,WAAWT,EAASU,mBACtCV,EAASW,qBAAqBH,GAC9BV,GAAiB,SAACvK,GAAD,mBAAC,eAAYA,GAAb,IAAgB6J,KAAMoB,EAAM,SAG/CH,GAEO,WACLC,OAAOM,qBAAqBhB,GAC5BC,EAAagB,YAGhB,CAACzM,IAECA,EAUE,cAAC8G,GAAD,aAAW+D,cAAeA,GAAmBU,IARhD,qBAAKtE,UAAU,8CAAf,SACE,cAAC,GAAD,CAASA,UAAU,wGAAnB,SACE,cAAC,GAAD,CAAUoC,cAAc,gCoBjCrBqD,GAA6B,SAAC,GAA+B,IAA7B1M,EAA4B,EAA5BA,WAAY0D,EAAgB,EAAhBA,UACvD,OACE,qBAAKuD,UAAU,gDAAf,SACE,sBAAKA,UAAU,oDAAf,UACE,cAACkE,GAAD,2BACMzH,EAAU,IADhB,IAEE9C,SAAS,MACTZ,WAAYA,EACZoL,WAAW,KAEZ1H,EAAUC,MAAM,GAAGgJ,KAAI,SAACvL,GAAD,OACtB,cAAC+J,GAAD,eAAgC/J,GAAjBA,EAAKT,iBCLjBiM,GCPgB,SAC3B9F,GAD2B,OAExB,SAACyE,GACJ,IAAM7B,EAAUC,eACVxG,EAAWyG,cACTjJ,EAAWkJ,YAAY3I,GAAvBP,OAHS,EAImBkJ,YAAYpG,EAAcf,MAAtD0B,EAJS,EAITA,WAAYtB,EAJH,EAIGA,YACZS,EAAWsJ,eAAXtJ,OAER4D,IAAMwE,WAAU,WACdhL,IAAWyD,GAAcjB,EAASR,EAAYoB,UAAU,CAAER,cACzD,CAAC5C,EAAQyD,IAEZ+C,IAAMwE,WACJ,kBAAM,WACJxI,EAASR,EAAYC,WAAW,UAElC,IAKF,OACE,eAAC,GAAD,CAAaqE,UAAU,kEAAvB,WACInE,GAAe,cAAC,GAAD,CAAayH,QAAM,EAAnB,wBAChBzH,GAAesB,GAAc,cAAC0C,EAAD,eAAeyE,IAC5CzI,IAAgBsB,GACf,eAAC,GAAD,CAAamF,KAAK,eAAKiB,QAPb,kBAAMd,EAAQM,KAAK,MAO7B,iCACsB,uBADtB,6BDpBY8C,EAAc,WAChC,IAAMpD,EAAUC,eACVxG,EAAWyG,cACTrG,EAAWsJ,eAAXtJ,OACAG,EAAcmG,YAAYpG,EAAcf,MAAxCgB,UAJ8B,EAKPmG,YAAY3I,GAAnCP,EAL8B,EAK9BA,OAAQX,EALsB,EAKtBA,WALsB,EAMAmH,IAAM4B,UAAS,GANf,oBAM/BgE,EAN+B,KAMlBC,EANkB,OAOE7F,IAAM4B,UAAS,GAPjB,oBAO/BkE,EAP+B,KAOjBC,EAPiB,OAQlB/F,IAAM4B,SAASlK,KAA5BgC,EAR+B,qBAUtCsG,IAAMwE,WAAU,WAEd,OADAwB,SAASC,MAAQ,CAAC,MAAO7J,GAAQ8J,KAAK,OAC/B,WACLF,SAASC,MAAQ,MACjBjK,EAASR,EAAYsB,UAAU,CAAEtD,YACjCwC,EAAShD,EAAYC,WAAW,CAAEJ,WAAY,WAE/C,IAEHmH,IAAMwE,WAAU,WACVjI,EAAUzE,SACZ+N,GAAe,IACdhN,GAAcmD,EAAShD,EAAYK,mBAErC,CAACkD,IAEJyD,IAAMwE,WAAU,YACTsB,GAAgBjN,IACnBmD,EAASR,EAAYkB,iBACrBqJ,GAAgB,MAEjB,CAAClN,IAEJ,IAEMiE,EAAY,WAChBd,EAASR,EAAYC,WAAW,OAChC8G,EAAQM,KAAK,MAef,OAAI+C,EACK,cAAC,GAAD,CAAaxC,QAAM,EAAnB,wBAGJ7G,EAAUzE,OAUVe,EAKH,eAAC,IAAMsN,SAAP,WACE,cAAC,GAAD,CAAY/J,OAAQA,EAAQmH,aAvCX,kBpC1CK6C,EoC0CarB,OAAOsB,SAASC,UpCzCvDtO,UAAUuO,UAAUC,UAAUJ,GADL,IAACA,KoCkFtB,cAAC,GAAD,CAAWvN,WAAYA,EAAY0D,UAAWA,IAC9C,cAAC,GAAD,CAAeO,UAAWA,OAPrB,cAAC,GAAD,CAAasG,QAAM,EAAnB,0CATL,cAAC,GAAD,CACE1J,UAAWA,EACXoD,UAAWA,EACXD,SArBW,SAAC,GAAwC,IAAtCpD,EAAqC,EAArCA,SAClBoM,GAAe,GACf7J,EACER,EAAYqB,SAAS,CACnBT,SACA5C,SACAC,WACAC,qBExDK+M,GAAM,WACjB,OACE,cAAC,GAAD,UACE,eAAC,KAAD,WACE,cAAC,KAAD,CAAOhI,KAAK,IAAIiI,OAAK,EAACC,UAAWrE,KACjC,cAAC,KAAD,CAAO7D,KAAK,WAAWiI,OAAK,EAACC,UAAWlB,W,OCFhDmB,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,IAAD,CAAOjL,MAAOA,GAAd,SACE,cAAC,IAAD,UACE,cAAC,GAAD,UAINmK,SAASe,eAAe,U,iBCjB1B,SAASC,EAAoBC,GAC5B,IAAIlF,EAAI,IAAImF,MAAM,uBAAyBD,EAAM,KAEjD,MADAlF,EAAEoF,KAAO,mBACHpF,EAEPiF,EAAoBI,KAAO,WAAa,MAAO,IAC/CJ,EAAoBK,QAAUL,EAC9BM,EAAOC,QAAUP,EACjBA,EAAoB/H,GAAK,K","file":"static/js/main.3445dff7.chunk.js","sourcesContent":["const emoji = ['🐨', '🐯', '🦁', '🐗', '🦝'];\r\n\r\nexport const getRandomEmoji = () => {\r\n  return emoji[Math.floor(Math.random() * Math.floor(emoji.length))];\r\n};\r\n\r\nexport const toClipboard = (text: string) => {\r\n  navigator.clipboard.writeText(text);\r\n};\r\n\r\nexport const getMediaStream = () => {\r\n  return navigator.mediaDevices\r\n    .getUserMedia({\r\n      audio: true,\r\n    })\r\n    .then((stream) => stream)\r\n    .catch((error) => error);\r\n};\r\n","import { call, put, take } from 'redux-saga/effects';\r\nimport { getMediaStream } from '../../utils';\r\nimport { userActions, UserTypes } from './';\r\n\r\nexport function* watchCreateStream() {\r\n  try {\r\n    while (true) {\r\n      yield take(UserTypes.CREATE_STREAM);\r\n      const userStream = yield call(getMediaStream);\r\n      yield userStream.active && put(userActions.updateUser({ userStream }));\r\n    }\r\n  } catch (error) {\r\n    // handle error\r\n  }\r\n}\r\n","const prefix = 'USER/';\r\n\r\nexport const UserTypes = {\r\n  UPDATE_USER: `${prefix}UPDATE_USER`,\r\n  CREATE_STREAM: `${prefix}CREATE_STREAM`,\r\n};\r\n\r\nexport interface UserState {\r\n  userId: string;\r\n  userName: string;\r\n  userEmoji: string;\r\n  userStream: MediaStream | null;\r\n}\r\n\r\nexport interface UpdateUserAction {\r\n  type: typeof UserTypes.UPDATE_USER;\r\n  payload: { [key in keyof Partial<UserState>]: any };\r\n}\r\n\r\nexport interface CreateStreamAction {\r\n  type: typeof UserTypes.CREATE_STREAM;\r\n}\r\n","import { createAction } from '@reduxjs/toolkit';\r\nimport { UserTypes, UpdateUserAction } from './types';\r\n\r\nexport const userActions = {\r\n  updateUser: createAction<UpdateUserAction['payload']>(UserTypes.UPDATE_USER),\r\n  createStream: createAction(UserTypes.CREATE_STREAM),\r\n};\r\n","import { createReducer } from '@reduxjs/toolkit';\r\nimport { UserTypes, UserState, UpdateUserAction } from './types';\r\n\r\nexport const userReducer = createReducer<UserState>(\r\n  {\r\n    userId: '',\r\n    userName: '',\r\n    userEmoji: '',\r\n    userStream: null,\r\n  },\r\n  {\r\n    [UserTypes.UPDATE_USER]: (state, { payload }: UpdateUserAction) => {\r\n      !payload.userStream && state.userStream?.getTracks()[0].stop();\r\n      state = { ...state, ...payload };\r\n      return state;\r\n    },\r\n  }\r\n);\r\n","import { RootState } from '../rootReducer';\r\nimport { UserState } from './types';\r\n\r\nexport const userSelectors = {\r\n  user: (s: RootState): UserState => s.user,\r\n};\r\n","const prefix = 'ROOM/';\r\n\r\nexport const RoomTypes = {\r\n  CREATE_ROOM: `${prefix}CREATE_ROOM`,\r\n  CHECK_ROOM: `${prefix}CHECK_ROOM`,\r\n  JOIN_ROOM: `${prefix}JOIN_ROOM`,\r\n  LEAVE_ROOM: `${prefix}LEAVE_ROOM`,\r\n  UPDATE_ROOM: `${prefix}UPDATE_ROOM`,\r\n  CALL_ROOM_USERS: `${prefix}CALL_ROOM_USERS`,\r\n  UPDATE_ROOM_USER: `${prefix}UPDATE_ROOM_USER`,\r\n  UPDATE_ROOM_USERS: `${prefix}UPDATE_ROOM_USERS`,\r\n};\r\n\r\nexport interface RoomUser {\r\n  userId: string;\r\n  userName: string;\r\n  userEmoji: string;\r\n  userStream: MediaStream | null;\r\n}\r\n\r\nexport interface RoomState {\r\n  roomId: string;\r\n  roomHost: string;\r\n  roomUsers: RoomUser[];\r\n  roomStatus: boolean;\r\n  roomChecked: boolean;\r\n}\r\n\r\nexport interface CreateRoomAction {\r\n  type: typeof RoomTypes.CREATE_ROOM;\r\n  payload: {\r\n    roomId: string;\r\n    userId: string;\r\n  };\r\n}\r\n\r\nexport interface CheckRoomAction {\r\n  type: typeof RoomTypes.CHECK_ROOM;\r\n  payload: {\r\n    roomId: string;\r\n  };\r\n}\r\n\r\nexport interface JoinRoomAction {\r\n  type: typeof RoomTypes.CREATE_ROOM;\r\n  payload: {\r\n    roomId: string;\r\n    userId: string;\r\n    userName: string;\r\n    userEmoji: string;\r\n  };\r\n}\r\n\r\nexport interface LeaveRoomAction {\r\n  type: typeof RoomTypes.LEAVE_ROOM;\r\n  payload: {\r\n    userId: string;\r\n  };\r\n}\r\n\r\nexport interface UpdateRoomAction {\r\n  type: typeof RoomTypes.UPDATE_ROOM;\r\n  payload: { [key in keyof Partial<RoomState>]: any } | null;\r\n}\r\n\r\nexport interface UpdateRoomUserAction {\r\n  type: typeof RoomTypes.UPDATE_ROOM_USER;\r\n  payload: Partial<RoomUser>;\r\n}\r\n\r\nexport interface UpdateRoomUsersAction {\r\n  type: typeof RoomTypes.UPDATE_ROOM_USERS;\r\n  payload: {\r\n    isNew: boolean;\r\n    roomUser: RoomUser;\r\n  };\r\n}\r\n","import Peer from 'peerjs';\r\nimport { eventChannel } from 'redux-saga';\r\nimport { call, take, put, select } from 'redux-saga/effects';\r\nimport { store } from '../';\r\nimport { userActions, userSelectors, UserState } from '../user';\r\nimport { roomActions, roomSelectors } from './';\r\nimport {\r\n  CheckRoomAction,\r\n  RoomState,\r\n  RoomTypes,\r\n  UpdateRoomAction,\r\n  UpdateRoomUsersAction,\r\n} from './types';\r\n\r\n/* global SocketIOClient */\r\n\r\nfunction roomChannel(socket: SocketIOClient.Socket, peer: Peer) {\r\n  return eventChannel((emit) => {\r\n    socket.on('room_update', (room: UpdateRoomAction['payload']) => {\r\n      emit(roomActions.updateRoom(room));\r\n    });\r\n    socket.on('room_update_users', (user: UpdateRoomUsersAction['payload']) => {\r\n      emit(roomActions.updateRoomUsers(user));\r\n    });\r\n    socket.on('room_status', (room: CheckRoomAction['payload']) => {\r\n      emit(roomActions.updateRoom({ ...room, roomChecked: true }));\r\n    });\r\n    peer.on('call', (call) => {\r\n      call.answer(store.getState().user.userStream as MediaStream);\r\n      call.on('stream', (remoteStream) => {\r\n        store.dispatch(\r\n          roomActions.updateRoomUser({\r\n            userId: call.peer,\r\n            userStream: remoteStream,\r\n          })\r\n        );\r\n      });\r\n    });\r\n    return () => {};\r\n  });\r\n}\r\n\r\nexport function* watchRoomChannel(socket: SocketIOClient.Socket, peer: Peer) {\r\n  try {\r\n    const channel = yield call(roomChannel, socket, peer);\r\n    while (true) {\r\n      const action = yield take(channel);\r\n      yield put(action);\r\n    }\r\n  } catch (error) {\r\n    // handle error\r\n  }\r\n}\r\n\r\nexport function* watchCreateRoom(socket: SocketIOClient.Socket) {\r\n  try {\r\n    while (true) {\r\n      const { payload } = yield take(RoomTypes.CREATE_ROOM);\r\n      socket.emit('room_create', payload);\r\n    }\r\n  } catch (error) {\r\n    // handle error\r\n  }\r\n}\r\n\r\nexport function* watchCheckRoom(socket: SocketIOClient.Socket) {\r\n  try {\r\n    while (true) {\r\n      const { payload } = yield take(RoomTypes.CHECK_ROOM);\r\n      socket.emit('room_check', payload);\r\n    }\r\n  } catch (error) {\r\n    // handle error\r\n  }\r\n}\r\n\r\nexport function* watchJoinRoom(socket: SocketIOClient.Socket) {\r\n  try {\r\n    while (true) {\r\n      const { payload } = yield take(RoomTypes.JOIN_ROOM);\r\n      const { roomId, ...user } = payload;\r\n      yield put(userActions.updateUser({ ...user }));\r\n      socket.emit('room_join', { roomId, ...user });\r\n    }\r\n  } catch (error) {\r\n    // handle error\r\n  }\r\n}\r\n\r\nexport function* watchCallRoomUsers(peer: Peer) {\r\n  try {\r\n    yield take(RoomTypes.CALL_ROOM_USERS);\r\n    const { roomUsers }: RoomState = yield select(roomSelectors.room);\r\n    const { userStream }: UserState = yield select(userSelectors.user);\r\n    roomUsers.slice(1).forEach(({ userId }) => {\r\n      const call = peer.call(userId, userStream as MediaStream);\r\n      call.on('stream', (remoteStream) => {\r\n        store.dispatch(\r\n          roomActions.updateRoomUser({\r\n            userId,\r\n            userStream: remoteStream,\r\n          })\r\n        );\r\n      });\r\n    });\r\n  } catch (error) {\r\n    // handler error\r\n  }\r\n}\r\n\r\nexport function* watchLeaveRoom(socket: SocketIOClient.Socket) {\r\n  try {\r\n    while (true) {\r\n      const { payload } = yield take(RoomTypes.LEAVE_ROOM);\r\n      socket.emit('room_leave', payload);\r\n    }\r\n  } catch (error) {\r\n    // handle error\r\n  }\r\n}\r\n","import { createAction } from '@reduxjs/toolkit';\r\nimport {\r\n  RoomTypes,\r\n  CreateRoomAction,\r\n  CheckRoomAction,\r\n  JoinRoomAction,\r\n  LeaveRoomAction,\r\n  UpdateRoomAction,\r\n  UpdateRoomUserAction,\r\n  UpdateRoomUsersAction,\r\n} from './types';\r\n\r\nexport const roomActions = {\r\n  callRoomUsers: createAction(RoomTypes.CALL_ROOM_USERS),\r\n  createRoom: createAction<CreateRoomAction['payload']>(RoomTypes.CREATE_ROOM),\r\n  checkRoom: createAction<CheckRoomAction['payload']>(RoomTypes.CHECK_ROOM),\r\n  joinRoom: createAction<JoinRoomAction['payload']>(RoomTypes.JOIN_ROOM),\r\n  leaveRoom: createAction<LeaveRoomAction['payload']>(RoomTypes.LEAVE_ROOM),\r\n  updateRoom: createAction<UpdateRoomAction['payload']>(RoomTypes.UPDATE_ROOM),\r\n  updateRoomUser: createAction<UpdateRoomUserAction['payload']>(\r\n    RoomTypes.UPDATE_ROOM_USER\r\n  ),\r\n  updateRoomUsers: createAction<UpdateRoomUsersAction['payload']>(\r\n    RoomTypes.UPDATE_ROOM_USERS\r\n  ),\r\n};\r\n","import { createReducer } from '@reduxjs/toolkit';\r\nimport {\r\n  RoomState,\r\n  RoomTypes,\r\n  UpdateRoomAction,\r\n  UpdateRoomUserAction,\r\n  UpdateRoomUsersAction,\r\n} from './types';\r\n\r\nconst initialState = {\r\n  roomId: '',\r\n  roomHost: '',\r\n  roomUsers: [],\r\n  roomStatus: false,\r\n  roomChecked: false,\r\n};\r\n\r\nexport const roomReducer = createReducer<RoomState>(initialState, {\r\n  [RoomTypes.UPDATE_ROOM]: (state, { payload }: UpdateRoomAction) => {\r\n    state = !payload ? initialState : { ...state, ...payload };\r\n    return state;\r\n  },\r\n  [RoomTypes.UPDATE_ROOM_USERS]: (\r\n    state,\r\n    { payload }: UpdateRoomUsersAction\r\n  ) => {\r\n    state.roomUsers = payload.isNew\r\n      ? [...state.roomUsers, payload.roomUser]\r\n      : state.roomUsers.filter((u) => u.userId !== payload.roomUser.userId);\r\n    return state;\r\n  },\r\n  [RoomTypes.UPDATE_ROOM_USER]: (state, { payload }: UpdateRoomUserAction) => {\r\n    const userIndex = state.roomUsers.findIndex(\r\n      (u) => u.userId === payload.userId\r\n    );\r\n    state.roomUsers[userIndex] = { ...state.roomUsers[userIndex], ...payload };\r\n    return state;\r\n  },\r\n});\r\n","import { RootState } from '../rootReducer';\r\nimport { RoomState } from './types';\r\n\r\nexport const roomSelectors = {\r\n  room: (s: RootState): RoomState => s.room,\r\n};\r\n","import { combineReducers } from 'redux';\r\nimport { userReducer as user, UserState } from './user';\r\nimport { roomReducer as room, RoomState } from './room';\r\n\r\nexport type RootState = {\r\n  user: UserState;\r\n  room: RoomState;\r\n};\r\n\r\nexport const rootReducer = combineReducers<RootState>({\r\n  user,\r\n  room,\r\n});\r\n","import Peer from 'peerjs';\r\nimport io from 'socket.io-client';\r\n\r\nconst IS_PROD = process.env.NODE_ENV === 'production';\r\n\r\nexport const connectSocket = () =>\r\n  new Promise((res) => {\r\n    const socket = io();\r\n    socket.on('connect', () => {\r\n      res(socket);\r\n    });\r\n  });\r\n\r\nexport const connectPeer = () =>\r\n  new Promise((res) => {\r\n    const peer = new Peer(sessionStorage.getItem('userId') || undefined, {\r\n      secure: IS_PROD,\r\n      host: IS_PROD ? 'app-hey.herokuapp.com' : '/',\r\n      port: IS_PROD ? 443 : 4000,\r\n      path: '/api/peer',\r\n      config: {\r\n        iceServers: [\r\n          { urls: 'stun:stun.l.google.com:19302' },\r\n          {\r\n            urls: 'turn:numb.viagenie.ca',\r\n            credential: 'muazkh',\r\n            username: 'webrtc@live.com',\r\n          },\r\n        ],\r\n      },\r\n    });\r\n    peer.on('open', (userId) => {\r\n      sessionStorage.setItem('userId', userId);\r\n      res(peer);\r\n    });\r\n  });\r\n","import { call, put, fork } from 'redux-saga/effects';\r\nimport { connectPeer, connectSocket } from './rootServices';\r\nimport { userActions, userSagas } from './user';\r\nimport { roomSagas } from './room';\r\n\r\nexport function* rootSaga() {\r\n  const peer = yield call(connectPeer);\r\n  const socket = yield call(connectSocket);\r\n  yield put(userActions.updateUser({ userId: peer.id }));\r\n  yield fork(userSagas.watchCreateStream);\r\n  yield fork(roomSagas.watchCreateRoom, socket);\r\n  yield fork(roomSagas.watchCheckRoom, socket);\r\n  yield fork(roomSagas.watchJoinRoom, socket);\r\n  yield fork(roomSagas.watchLeaveRoom, socket);\r\n  yield fork(roomSagas.watchCallRoomUsers, peer);\r\n  yield fork(roomSagas.watchRoomChannel, socket, peer);\r\n}\r\n","import { createStore, applyMiddleware } from 'redux';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport createSagaMiddleware from 'redux-saga';\r\nimport { rootReducer } from './rootReducer';\r\nimport { rootSaga } from './rootSaga';\r\n\r\nconst sagaMiddleware = createSagaMiddleware();\r\n\r\nexport const store = createStore(\r\n  rootReducer,\r\n  composeWithDevTools(applyMiddleware(sagaMiddleware))\r\n);\r\n\r\nsagaMiddleware.run(rootSaga);\r\n\r\nexport * from './rootReducer';\r\n","import React from 'react';\r\nimport { UIPaper, UILoader } from '../../components/UI';\r\n\r\ntype Props = {\r\n  userStream: MediaStream | null;\r\n};\r\n\r\nexport const withStreamAnalyzer = <T extends Props>(\r\n  Component: React.ComponentType<T>\r\n) => (props: T) => {\r\n  let requestId: number;\r\n  let audioContext: AudioContext;\r\n\r\n  const { userStream } = props;\r\n  const [analyzerState, setAnalyzerState] = React.useState({ size: 0 });\r\n\r\n  React.useEffect(() => {\r\n    if (userStream && !audioContext) {\r\n      audioContext = new AudioContext();\r\n      const analyzer = audioContext.createAnalyser();\r\n      audioContext.createMediaStreamSource(userStream).connect(analyzer);\r\n\r\n      const updateAnalyzerState = () => {\r\n        requestId = window.requestAnimationFrame(updateAnalyzerState);\r\n        const array = new Uint8Array(analyzer.frequencyBinCount);\r\n        analyzer.getByteFrequencyData(array);\r\n        setAnalyzerState((s) => ({ ...s, size: array[15] }));\r\n      };\r\n\r\n      updateAnalyzerState();\r\n\r\n      return () => {\r\n        window.cancelAnimationFrame(requestId);\r\n        audioContext.close();\r\n      };\r\n    }\r\n  }, [userStream]);\r\n\r\n  if (!userStream) {\r\n    return (\r\n      <div className=\"2xl:w-1/4 lg:w-1/3 sm:w-1/2 w-full h-64 p-2\">\r\n        <UIPaper className=\"relative flex items-center justify-center h-full px-2 py-3.5 border-6 border-gray-900 overflow-hidden\">\r\n          <UILoader classNameItem=\"w-16 h-16 bg-gray-700\" />\r\n        </UIPaper>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <Component analyzerState={analyzerState} {...props} />;\r\n};\r\n","import React from 'react';\r\n\r\nexport const UIAppLayout: React.FC = ({ children }) => {\r\n  return (\r\n    <div className=\"w-full font-medium text-gray-200 bg-gray-900\">\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\n\r\ntype Props = {\r\n  userStream: MediaStream;\r\n  audioState: {\r\n    muted: boolean;\r\n  };\r\n};\r\n\r\nexport const UIAudioStream: React.FC<Props> = React.memo(\r\n  ({ userStream, audioState }) => {\r\n    const audioRef = React.useRef<HTMLAudioElement>(null);\r\n\r\n    React.useLayoutEffect(() => {\r\n      if (audioRef.current && !audioRef.current?.srcObject) {\r\n        audioRef.current.srcObject = userStream;\r\n        audioRef.current.play();\r\n      }\r\n    }, [audioRef, userStream]);\r\n\r\n    React.useLayoutEffect(() => {\r\n      if (audioRef.current) {\r\n        audioRef.current.volume = audioState.muted ? 0 : 1;\r\n      }\r\n    }, [audioState.muted]);\r\n\r\n    return <audio ref={audioRef} />;\r\n  }\r\n);\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\ntype Props = {\r\n  className?: string;\r\n};\r\n\r\nexport const UIBar: React.FC<Props> = ({ className = '', children }) => {\r\n  return (\r\n    <div\r\n      className={cx(\r\n        className,\r\n        'sticky z-10 left-0 flex items-center w-full px-3 py-4 bg-gray-900 bg-opacity-90'\r\n      )}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\ntype Props = {\r\n  type?: 'button' | 'submit';\r\n  className?: string;\r\n  classIcon?: string;\r\n  onClick?: () => void;\r\n};\r\n\r\nexport const UIButton: React.FC<Props> = ({\r\n  type = 'button',\r\n  className = '',\r\n  classIcon = '',\r\n  onClick,\r\n  children,\r\n}) => {\r\n  return (\r\n    <button\r\n      type={type}\r\n      className={cx(\r\n        className,\r\n        'flex items-center justify-center px-5 py-2 border-3 rounded-xl font-extrabold uppercase space-x-4 transition duration-100 ring-0 focus:ring-3 focus:outline-none hover:opacity-90'\r\n      )}\r\n      onClick={onClick || (() => {})}\r\n    >\r\n      {classIcon && <i className={cx(classIcon, 'text-sm')} />}\r\n      <span>{children}</span>\r\n    </button>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\ntype Props = {\r\n  className?: string;\r\n};\r\n\r\nexport const UIContainer: React.FC<Props> = ({ className = '', children }) => {\r\n  return (\r\n    <div className={cx(className, 'container mx-auto px-5')}>{children}</div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\ntype Props = Partial<{\r\n  state: boolean;\r\n  onClass: string;\r\n  offClass: string;\r\n}>;\r\n\r\nexport const UIIconToggle: React.FC<Props> = ({\r\n  state,\r\n  onClass = '',\r\n  offClass = '',\r\n}) => {\r\n  return <i className={cx({ [onClass]: state, [offClass]: !state })} />;\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\ntype Props = {\r\n  name: string;\r\n  type?: 'text' | 'number';\r\n  initialState?: string | number;\r\n  placeholder?: string;\r\n  className?: string;\r\n  autoFocus?: boolean;\r\n  register?: () => void;\r\n  onChange?: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n};\r\n\r\nexport const UIInput = ({\r\n  name,\r\n  type = 'text',\r\n  initialState = '',\r\n  placeholder = '',\r\n  className = '',\r\n  autoFocus = false,\r\n  register,\r\n  onChange,\r\n}: Props) => {\r\n  const [value, setValue] = React.useState(initialState);\r\n\r\n  const changeValue = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setValue(e.target.value);\r\n    onChange && onChange(e);\r\n  };\r\n\r\n  return (\r\n    <input\r\n      type={type}\r\n      name={name}\r\n      value={value}\r\n      ref={register}\r\n      autoFocus={autoFocus}\r\n      placeholder={placeholder}\r\n      className={cx(\r\n        className,\r\n        'px-5 py-2.5 border-3 border-transparent rounded-xl font-medium placeholder-gray-400 bg-transparent transition duration-100 ring-0 focus:ring-3 focus:outline-none hover:opacity-90'\r\n      )}\r\n      onChange={changeValue}\r\n    />\r\n  );\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\nimport './UILoader.css';\r\n\r\ntype Props = {\r\n  className?: string;\r\n  classNameItem?: string;\r\n};\r\n\r\nexport const UILoader: React.FC<Props> = ({ className, classNameItem }) => {\r\n  return (\r\n    <div className={cx('loader-double-bounce', className)}>\r\n      <div\r\n        className={cx('loader-child loader-double-bounce-1', classNameItem)}\r\n      />\r\n      <div\r\n        className={cx('loader-child loader-double-bounce-2', classNameItem)}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\nimport { getRandomEmoji } from '../../utils';\r\n\r\ntype Props = {\r\n  icon?: string;\r\n  className?: string;\r\n};\r\n\r\nexport const UILogo: React.FC<Props> = React.memo(({ icon, className }) => {\r\n  return (\r\n    <div\r\n      className={cx(\r\n        className,\r\n        'flex items-center justify-center rounded-full bg-gray-700 bg-opacity-50 select-none'\r\n      )}\r\n    >\r\n      {icon || getRandomEmoji()}\r\n    </div>\r\n  );\r\n});\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\ntype Props = {\r\n  className?: string;\r\n};\r\n\r\nexport const UIPaper: React.FC<Props> = ({ className = '', children }) => {\r\n  return (\r\n    <div className={cx(className, 'rounded-2xl bg-gray-800')}>{children}</div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory } from 'react-router-dom';\r\nimport shortid from 'shortid';\r\nimport { userSelectors } from '../../store/user';\r\nimport { roomActions } from '../../store/room';\r\nimport { UIContainer, UILogo, UIButton } from '../../components/UI';\r\n\r\nexport const Start = () => {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const { userId } = useSelector(userSelectors.user);\r\n\r\n  const handleCreateCallRoom = () => {\r\n    const roomId = shortid.generate();\r\n    dispatch(\r\n      roomActions.createRoom({\r\n        roomId,\r\n        userId,\r\n      })\r\n    );\r\n    history.push(`/${roomId}`);\r\n  };\r\n\r\n  return (\r\n    <UIContainer className=\"flex items-center justify-center min-h-screen\">\r\n      <div className=\"xl:w-6/12 md:w-8/12 text-center space-y-12\">\r\n        <div className=\"space-y-6\">\r\n          <UILogo icon=\"👋\" className=\"w-32 h-32 mx-auto text-6xl\" />\r\n          <p className=\"sm:text-5xl text-4xl font-extrabold\">\r\n            Create call room in a click and invite someone...\r\n          </p>\r\n        </div>\r\n        <UIButton\r\n          className=\"mx-auto border-gray-900 text-lg ring-gray-700 bg-gray-800\"\r\n          onClick={handleCreateCallRoom}\r\n        >\r\n          Create call room\r\n        </UIButton>\r\n      </div>\r\n    </UIContainer>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { UIButton, UIBar } from '../../../components/UI';\r\n\r\ntype Props = {\r\n  leaveRoom: () => void;\r\n};\r\n\r\nexport const RoomBottomBar: React.FC<Props> = ({ leaveRoom }) => {\r\n  return (\r\n    <UIBar className=\"bottom-0 justify-center space-x-4\">\r\n      {/* <UIButton\r\n        className=\"sm:w-auto w-full border-gray-900 ring-gray-700 bg-gray-800\"\r\n        classIcon=\"fas fa-microphone\"\r\n        onClick={() => {}}\r\n      >\r\n        Mute\r\n      </UIButton>\r\n      <span className=\"text-3xl text-gray-800\">|</span> */}\r\n      <UIButton\r\n        className=\"sm:w-auto w-full border-gray-900 ring-red-700 bg-red-800\"\r\n        classIcon=\"fas fa-sign-out-alt\"\r\n        onClick={leaveRoom}\r\n      >\r\n        Leave\r\n      </UIButton>\r\n    </UIBar>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { UIInput, UIButton, UILogo } from '../../../components/UI';\r\n\r\ntype Props = {\r\n  userEmoji: string;\r\n  joinRoom: ({ userName }: { userName: string }) => void;\r\n  leaveRoom: () => void;\r\n};\r\n\r\nexport const RoomEnter: React.FC<Props> = ({\r\n  userEmoji,\r\n  leaveRoom,\r\n  joinRoom,\r\n}) => {\r\n  const { register, handleSubmit } = useForm();\r\n\r\n  return (\r\n    <div className=\"xl:w-1/3 lg:w-5/12 md:w-7/12 sm:w-2/3 w-full space-y-9\">\r\n      <div className=\"space-y-4\">\r\n        <UILogo className=\"w-24 h-24 mx-auto text-4.5xl\" icon={userEmoji} />\r\n        <h3 className=\"text-center text-4xl font-bold\">\r\n          Enter your name <br /> to join call room\r\n        </h3>\r\n      </div>\r\n      <form\r\n        className=\"w-full sm:px-16 px-9 rounded-xl space-y-4\"\r\n        onSubmit={handleSubmit(joinRoom)}\r\n      >\r\n        <UIInput\r\n          className=\"w-full mb-5 border-gray-900 ring-gray-700 bg-gray-800 bg-opacity-75\"\r\n          name=\"userName\"\r\n          placeholder=\"Your name\"\r\n          register={register}\r\n          autoFocus\r\n        />\r\n        <div className=\"flex sm:flex-row-reverse flex-col sm:flex-nowrap flex-wrap items-center\">\r\n          <UIButton\r\n            className=\"w-full border-gray-900 ring-red-800 bg-red-800\"\r\n            type=\"submit\"\r\n            classIcon=\"fas fa-sign-in-alt\"\r\n          >\r\n            Enter\r\n          </UIButton>\r\n          <UIButton\r\n            className=\"w-full sm:mr-2 border-gray-900 ring-gray-700 bg-gray-800\"\r\n            classIcon=\"fas fa-arrow-left\"\r\n            onClick={leaveRoom}\r\n          >\r\n            Leave\r\n          </UIButton>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\nimport { UILogo, UIButton, UILoader } from '../../../components/UI';\r\n\r\ntype Props = {\r\n  icon?: string;\r\n  loader?: boolean;\r\n  toStart?: () => void;\r\n};\r\n\r\nexport const RoomMessage: React.FC<Props> = ({\r\n  icon = '',\r\n  loader = false,\r\n  toStart,\r\n  children,\r\n}) => {\r\n  return (\r\n    <div className=\"lg:w-5/12 md:w-7/12 sm:w-2/3 w-full space-y-9\">\r\n      <div className=\"space-y-4\">\r\n        {icon && !loader && (\r\n          <UILogo className=\"w-24 h-24 mx-auto text-4.5xl\" icon={icon} />\r\n        )}\r\n        {loader && (\r\n          <UILoader className=\"w-20 h-20\" classNameItem=\"bg-gray-700\" />\r\n        )}\r\n        <h3\r\n          className={cx(\r\n            'font-bold  text-center',\r\n            loader ? 'text-3xl text-gray-700' : 'text-4xl'\r\n          )}\r\n        >\r\n          {children}\r\n        </h3>\r\n      </div>\r\n      {toStart && (\r\n        <UIButton\r\n          className=\"mx-auto border-gray-900 ring-gray-700 bg-gray-800\"\r\n          classIcon=\"fas fa-arrow-left\"\r\n          onClick={toStart}\r\n        >\r\n          Leave\r\n        </UIButton>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { UIBar, UIButton } from '../../../components/UI';\r\n\r\ntype Props = {\r\n  roomId: string;\r\n  copyRoomLink: () => void;\r\n};\r\n\r\nexport const RoomTopBar: React.FC<Props> = ({ roomId, copyRoomLink }) => {\r\n  return (\r\n    <UIBar className=\"top-0 justify-between\">\r\n      <UIButton\r\n        className=\"border-gray-900 ring-gray-700 bg-gray-800\"\r\n        classIcon=\"fas fa-clone\"\r\n        onClick={copyRoomLink}\r\n      >\r\n        Copy link\r\n      </UIButton>\r\n      <span className=\"text-lg font-bold\">\r\n        <span className=\"text-gray-600\">Room ID:</span> {roomId}\r\n      </span>\r\n    </UIBar>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\ntype Props = {\r\n  className?: string;\r\n  onClick?: () => void;\r\n};\r\n\r\nexport const RoomUserAction: React.FC<Props> = ({\r\n  className = '',\r\n  onClick,\r\n  children,\r\n}) => (\r\n  <button\r\n    className={cx(\r\n      className,\r\n      'flex items-center justify-center w-11 h-7 py-3 border-3 border-gray-900 rounded-md text-sm bg-gray-800 focus:ring-3 ring-gray-700 focus:outline-none'\r\n    )}\r\n    onClick={onClick}\r\n  >\r\n    {children}\r\n  </button>\r\n);\r\n","import React from 'react';\r\n\r\ntype Props = {\r\n  analyzerState?: { size: number };\r\n};\r\n\r\nexport const RoomUserAnalyzer = ({ analyzerState }: Props) => {\r\n  return (\r\n    <div\r\n      style={{\r\n        width: analyzerState?.size || 0,\r\n        height: analyzerState?.size || 0,\r\n      }}\r\n      className=\"rounded-full bg-gray-700 bg-opacity-25 transition duration-150\"\r\n    />\r\n  );\r\n};\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\ntype Props = {\r\n  className?: string;\r\n};\r\n\r\nexport const RoomUserItem: React.FC<Props> = ({ className = '', children }) => (\r\n  <div\r\n    className={cx(\r\n      className,\r\n      'flex items-center justify-center min-w-10 h-7 rounded-md bg-gray-900'\r\n    )}\r\n  >\r\n    {children}\r\n  </div>\r\n);\r\n","import React from 'react';\r\nimport cx from 'classnames';\r\nimport { RoomUser as IRoomUser } from '../../store/room';\r\nimport {\r\n  UILogo,\r\n  UIPaper,\r\n  UIIconToggle,\r\n  UIAudioStream,\r\n} from '../../components/UI';\r\nimport { withStreamAnalyzer } from './withStreamAnalyzer';\r\nimport { RoomUserItem, RoomUserAction, RoomUserAnalyzer } from './components';\r\n\r\ninterface Props extends IRoomUser {\r\n  userStream: MediaStream | null;\r\n  analyzerState?: { size: number };\r\n  withMuted?: boolean;\r\n}\r\n\r\nexport const RoomUser: React.FC<Props> = withStreamAnalyzer(\r\n  ({ userName, userEmoji, userStream, analyzerState, withMuted = true }) => {\r\n    const [audioState, setAudioState] = React.useState({ muted: !withMuted });\r\n\r\n    const toggleMutedUser = () => {\r\n      setAudioState((s) => ({ ...s, muted: !s.muted }));\r\n    };\r\n\r\n    return (\r\n      <div className=\"2xl:w-1/4 lg:w-1/3 sm:w-1/2 w-full h-64 p-2\">\r\n        <UIPaper\r\n          className={cx(\r\n            'relative flex items-center justify-center h-full px-2 py-3.5 border-6 border-gray-900 overflow-hidden ring-0 transition duration-150',\r\n            {\r\n              'ring-3 ring-green-500': Number(analyzerState?.size) > 100,\r\n            }\r\n          )}\r\n        >\r\n          <div className=\"absolute top-2 right-2 flex space-x-2\">\r\n            {withMuted && (\r\n              <RoomUserAction onClick={toggleMutedUser}>\r\n                <UIIconToggle\r\n                  state={!audioState.muted}\r\n                  onClass=\"fas fa-volume-up\"\r\n                  offClass=\"fas fa-volume-mute text-lg text-red-600\"\r\n                />\r\n              </RoomUserAction>\r\n            )}\r\n          </div>\r\n          <UILogo\r\n            className=\"absolute top-50 left-50 w-32 h-32 text-6xl\"\r\n            icon={userEmoji}\r\n          />\r\n          <RoomUserAnalyzer analyzerState={analyzerState} />\r\n          <div className=\"absolute bottom-1.5 left-2 flex space-x-2\">\r\n            <RoomUserItem>\r\n              <UIIconToggle\r\n                state={true}\r\n                onClass=\"fas fa-microphone\"\r\n                offClass=\"fas fa-microphone-slash text-red-600\"\r\n              />\r\n            </RoomUserItem>\r\n            <RoomUserItem className=\"px-3\">\r\n              {userName || 'Someone'}\r\n            </RoomUserItem>\r\n          </div>\r\n        </UIPaper>\r\n        {userStream && (\r\n          <UIAudioStream userStream={userStream} audioState={audioState} />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n","import React from 'react';\r\nimport { RoomUser as IRoomUser } from '../../../store/room';\r\nimport { RoomUser } from '../../RoomUser';\r\n\r\ntype Props = {\r\n  userStream: MediaStream | null;\r\n  roomUsers: IRoomUser[];\r\n};\r\n\r\nexport const RoomUsers: React.FC<Props> = ({ userStream, roomUsers }) => {\r\n  return (\r\n    <div className=\"relative w-full flex-1 flex items-center py-3\">\r\n      <div className=\"w-full flex flex-wrap items-center justify-center\">\r\n        <RoomUser\r\n          {...roomUsers[0]}\r\n          userName=\"You\"\r\n          userStream={userStream}\r\n          withMuted={false}\r\n        />\r\n        {roomUsers.slice(1).map((user) => (\r\n          <RoomUser key={user.userId} {...user} />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport { getRandomEmoji, toClipboard } from '../../utils';\r\nimport { roomActions, roomSelectors } from '../../store/room';\r\nimport { userActions, userSelectors } from '../../store/user';\r\nimport { withRoomCheck } from './withRoomCheck';\r\nimport {\r\n  RoomTopBar,\r\n  RoomEnter,\r\n  RoomUsers,\r\n  RoomMessage,\r\n  RoomBottomBar,\r\n} from './components';\r\n\r\nexport const Room = withRoomCheck(() => {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const { roomId } = useParams<{ roomId: string }>();\r\n  const { roomUsers } = useSelector(roomSelectors.room);\r\n  const { userId, userStream } = useSelector(userSelectors.user);\r\n  const [loadingRoom, setLoadingRoom] = React.useState(false);\r\n  const [isCalledRoom, setIsCalledRoom] = React.useState(false);\r\n  const [userEmoji] = React.useState(getRandomEmoji());\r\n\r\n  React.useEffect(() => {\r\n    document.title = ['Hey', roomId].join(' | ');\r\n    return () => {\r\n      document.title = 'Hey';\r\n      dispatch(roomActions.leaveRoom({ userId }));\r\n      dispatch(userActions.updateUser({ userStream: null }));\r\n    };\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    if (roomUsers.length) {\r\n      setLoadingRoom(false);\r\n      !userStream && dispatch(userActions.createStream());\r\n    }\r\n  }, [roomUsers]);\r\n\r\n  React.useEffect(() => {\r\n    if (!isCalledRoom && userStream) {\r\n      dispatch(roomActions.callRoomUsers());\r\n      setIsCalledRoom(true);\r\n    }\r\n  }, [userStream]);\r\n\r\n  const copyRoomLink = () => toClipboard(window.location.href);\r\n\r\n  const leaveRoom = () => {\r\n    dispatch(roomActions.updateRoom(null));\r\n    history.push('/');\r\n  };\r\n\r\n  const joinRoom = ({ userName }: { userName: string }) => {\r\n    setLoadingRoom(true);\r\n    dispatch(\r\n      roomActions.joinRoom({\r\n        roomId,\r\n        userId,\r\n        userName,\r\n        userEmoji,\r\n      })\r\n    );\r\n  };\r\n\r\n  if (loadingRoom) {\r\n    return <RoomMessage loader>Loading...</RoomMessage>;\r\n  }\r\n\r\n  if (!roomUsers.length) {\r\n    return (\r\n      <RoomEnter\r\n        userEmoji={userEmoji}\r\n        leaveRoom={leaveRoom}\r\n        joinRoom={joinRoom}\r\n      />\r\n    );\r\n  }\r\n\r\n  if (!userStream) {\r\n    return <RoomMessage loader>Please allow to use micro...</RoomMessage>;\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <RoomTopBar roomId={roomId} copyRoomLink={copyRoomLink} />\r\n      <RoomUsers userStream={userStream} roomUsers={roomUsers} />\r\n      <RoomBottomBar leaveRoom={leaveRoom} />\r\n    </React.Fragment>\r\n  );\r\n});\r\n","import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport { roomActions, roomSelectors } from '../../store/room';\r\nimport { userSelectors } from '../../store/user';\r\nimport { UIContainer } from '../../components/UI';\r\nimport { RoomMessage } from './components';\r\n\r\nexport const withRoomCheck = <T extends {}>(\r\n  Component: React.ComponentType<T>\r\n) => (props: T) => {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const { userId } = useSelector(userSelectors.user);\r\n  const { roomStatus, roomChecked } = useSelector(roomSelectors.room);\r\n  const { roomId } = useParams<{ roomId: string }>();\r\n\r\n  React.useEffect(() => {\r\n    userId && !roomStatus && dispatch(roomActions.checkRoom({ roomId }));\r\n  }, [userId, roomStatus]);\r\n\r\n  React.useEffect(\r\n    () => () => {\r\n      dispatch(roomActions.updateRoom(null));\r\n    },\r\n    []\r\n  );\r\n\r\n  const toStart = () => history.push('/');\r\n\r\n  return (\r\n    <UIContainer className=\"relative min-h-screen flex flex-col items-center justify-center\">\r\n      {!roomChecked && <RoomMessage loader>Loading...</RoomMessage>}\r\n      {roomChecked && roomStatus && <Component {...props} />}\r\n      {roomChecked && !roomStatus && (\r\n        <RoomMessage icon=\"😕\" toStart={toStart}>\r\n          Call room not found <br /> or closed by host!\r\n        </RoomMessage>\r\n      )}\r\n    </UIContainer>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { Switch, Route } from 'react-router-dom';\r\nimport { UIAppLayout } from './components/UI';\r\nimport { Start } from './scenes/Start';\r\nimport { Room } from './scenes/Room';\r\n\r\nexport const App = () => {\r\n  return (\r\n    <UIAppLayout>\r\n      <Switch>\r\n        <Route path=\"/\" exact component={Start} />\r\n        <Route path=\"/:roomId\" exact component={Room} />\r\n      </Switch>\r\n    </UIAppLayout>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\nimport { Provider as Store } from 'react-redux';\r\nimport { store } from './store';\r\nimport { App } from './App';\r\n\r\nimport './styles/index.css';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Store store={store}>\r\n      <Router>\r\n        <App />\r\n      </Router>\r\n    </Store>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 78;"],"sourceRoot":""}